[["estadística-bivariantes.html", "Chapter 6 Estadística bivariantes 6.1 Ejercicio 1 6.2 Ejercicio 2 6.3 Ejercicio 3 6.4 Ejercicio 3 6.5 Ejercicio 4 6.6 Ejercicio 5 6.7 Ejercicio 6 6.8 Ejercicio 7 6.9 pie chart 6.10 Ejercicio 8 6.11 Ejercicio 9 6.12 Ejercicio 10 6.13 Ejercicio 11 6.14 Ejercicio 12 6.15 Ejercicio 13 6.16 Ejercicio 14 6.17 Ejercicio 15 6.18 Ejercicio 16", " Chapter 6 Estadística bivariantes 6.1 Ejercicio 1 EJEMPLO library(haven) estudiantes &lt;- read_spss(&quot;Estudiantes1.sav&quot;) tb &lt;- table(estudiantes$tabac37, estudiantes$Sexo) dimnames(tb) = list( c(&quot;No&quot;, &quot;Sí&quot;), c(&quot;Hombre&quot;, &quot;Mujer&quot;)) addmargins(tb) ## Hombre Mujer Sum ## No 25 83 108 ## Sí 20 38 58 ## Sum 45 121 166 proportion_table &lt;- round(prop.table(tb, margin = 2)*100,1) addmargins(proportion_table) ## Hombre Mujer Sum ## No 55.6 68.6 124.2 ## Sí 44.4 31.4 75.8 ## Sum 100.0 100.0 200.0 6.2 Ejercicio 2 EJEMPLO tb &lt;- table(estudiantes$actf36, estudiantes$Sexo) dimnames(tb) = list( c(&quot;Sedentario poco activo&quot;, &quot;Moderadamente activo&quot;, &quot;Activo&quot;), c(&quot;Hombre&quot;, &quot;Mujer&quot;)) addmargins(tb) ## Hombre Mujer Sum ## Sedentario poco activo 11 77 88 ## Moderadamente activo 8 27 35 ## Activo 24 15 39 ## Sum 43 119 162 proportion_table &lt;- round(prop.table(tb, margin = 2)*100,1) addmargins(proportion_table) ## Hombre Mujer Sum ## Sedentario poco activo 25.6 64.7 90.3 ## Moderadamente activo 18.6 22.7 41.3 ## Activo 55.8 12.6 68.4 ## Sum 100.0 100.0 200.0 6.3 Ejercicio 3 EJEMPLO Por ejemplo si queremos hacer un subanálisis en los que tienen 23 años. estudiantes_23 &lt;- estudiantes %&gt;% filter(Edad==23) tb &lt;- table(estudiantes_23$tabac37, estudiantes_23$Sexo) dimnames(tb) = list( c(&quot;No&quot;, &quot;Sí&quot;), c(&quot;Hombre&quot;, &quot;Mujer&quot;)) addmargins(tb) ## Hombre Mujer Sum ## No 11 45 56 ## Sí 2 16 18 ## Sum 13 61 74 proportion_table &lt;- round(prop.table(tb, margin = 2)*100,1) addmargins(proportion_table) ## Hombre Mujer Sum ## No 84.6 73.8 158.4 ## Sí 15.4 26.2 41.6 ## Sum 100.0 100.0 200.0 6.4 Ejercicio 3 EJEMPLO summary(estudiantes$Edad) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 19.00 23.00 23.00 23.73 24.00 41.00 sd(estudiantes$Edad) ## [1] 2.631208 IQR(estudiantes$Edad) ## [1] 1 with(estudiantes, tapply(Edad, Sexo, summary, na.rm=T)) ## $`1` ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 19.00 22.00 23.00 23.91 25.00 41.00 ## ## $`2` ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 19.00 23.00 23.00 23.67 24.00 32.00 summary(estudiantes$PESO) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 44.40 55.55 61.05 64.16 71.45 103.50 sd(estudiantes$PESO) ## [1] 11.56629 IQR(estudiantes$PESO) ## [1] 15.9 with(estudiantes, tapply(PESO, Sexo, summary, na.rm=T)) ## $`1` ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 56.10 67.90 75.00 74.64 79.90 93.40 ## ## $`2` ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 44.40 54.10 58.40 60.26 63.00 103.50 6.5 Ejercicio 4 EJEMPLO # Cargar los paquetes necesarias library(ggplot2) # Generar datos para el ejemplo set.seed(123) x &lt;- seq(1, 10, by = 0.5) y_positive &lt;- x + rnorm(length(x), mean = 0, sd = 1) # Correlación positiva y_negative &lt;- -x + rnorm(length(x), mean = 0, sd = 1) # Correlación negativa y_no_corr &lt;- rnorm(length(x), mean = 0, sd = 1) # Sin correlación # Calcular las correlaciones cor_positive &lt;- cor(x, y_positive, method = &quot;pearson&quot;) cor_negative &lt;- cor(x, y_negative, method = &quot;pearson&quot;) cor_no_corr &lt;- cor(x, y_no_corr, method = &quot;pearson&quot;) # Generar los gráficos plot_positive &lt;- ggplot(data = data.frame(x, y_positive), aes(x, y_positive)) + geom_point() + geom_smooth(method = &quot;lm&quot;, color = &quot;blue&quot;) + labs(title = paste(&quot;Positive Correlation (correlation =&quot;, round(cor_positive, 2), &quot;)&quot;)) plot_negative &lt;- ggplot(data = data.frame(x, y_negative), aes(x, y_negative)) + geom_point() + geom_smooth(method = &quot;lm&quot;, color = &quot;red&quot;) + labs(title = paste(&quot;Negative Correlation (correlation =&quot;, round(cor_negative, 2), &quot;)&quot;)) plot_no_corr &lt;- ggplot(data = data.frame(x, y_no_corr), aes(x, y_no_corr)) + geom_point() + geom_smooth(method = &quot;lm&quot;, color = &quot;green&quot;) + labs(title = paste(&quot;No Correlation (correlation =&quot;, round(cor_no_corr, 2), &quot;)&quot;)) # Mostrar los gráficos print(plot_positive) ## `geom_smooth()` using formula = &#39;y ~ x&#39; print(plot_negative) ## `geom_smooth()` using formula = &#39;y ~ x&#39; print(plot_no_corr) ## `geom_smooth()` using formula = &#39;y ~ x&#39; 6.6 Ejercicio 5 EJEMPLO base &lt;- read_spss(&quot;base1.sav&quot;) with(base, cor.test(peso_m, altura_m, alternative=&quot;two.sided&quot;, method = &quot;spearman&quot;)) ## ## Spearman&#39;s rank correlation rho ## ## data: peso_m and altura_m ## S = 24127530, p-value &lt; 2.2e-16 ## alternative hypothesis: true rho is not equal to 0 ## sample estimates: ## rho ## 0.3653392 6.7 Ejercicio 6 EJEMPLO shapiro.test(estudiantes$Edad) ## ## Shapiro-Wilk normality test ## ## data: estudiantes$Edad ## W = 0.77873, p-value = 1.464e-14 ks.test(estudiantes$Edad, &#39;pnorm&#39;) ## ## Asymptotic one-sample Kolmogorov-Smirnov test ## ## data: estudiantes$Edad ## D = 1, p-value &lt; 2.2e-16 ## alternative hypothesis: two-sided R code - histograma # Creating the histogram with ggplot2 ggplot(estudiantes, aes(x = Edad)) + geom_histogram(binwidth = 1, color = &quot;black&quot;, fill = &quot;blue&quot;) + labs(title = &quot;Histograma para revisar normalidad&quot;, x = &quot;Valores datos&quot;, y = &quot;Frecuencia&quot;) R code - gráfico QQ qqnorm(estudiantes$Edad, pch = 1, frame = FALSE) qqline(estudiantes$Edad, col = &quot;steelblue&quot;, lwd = 2) library(&quot;car&quot;) ## Loading required package: carData ## ## Attaching package: &#39;car&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## recode ## The following object is masked from &#39;package:purrr&#39;: ## ## some qqPlot(estudiantes$Edad) ## [1] 65 66 6.8 Ejercicio 7 EJEMPLO 6.9 pie chart library(tidyverse); library(ggplot2) # Load ggplot2 data &lt;- data.frame(group=LETTERS[1:5], value=c(13,7,9,21,2)) # Create Data ggplot(data, aes(x=&quot;&quot;, y=value, fill=group)) + geom_bar(stat=&quot;identity&quot;, width=1, color=&quot;white&quot;) + coord_polar(&quot;y&quot;, start=0) + # Basic piechart theme_void() # remove background, grid, numeric labels Barplot library(ggplot2) # Load ggplot2 data &lt;- data.frame(name=c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;) ,value=c(3,12,5,18,45)) # Create data ggplot(data, aes(x=name, y=value)) + geom_bar(stat = &quot;identity&quot;)# Barplot Boxplot library(tidyverse); library(hrbrthemes); library(viridis)# Libraries # create a dataset data &lt;- data.frame( name=c( rep(&quot;A&quot;,500), rep(&quot;B&quot;,500), rep(&quot;B&quot;,500), rep(&quot;C&quot;,20), rep(&#39;D&#39;, 100) ), value=c(rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1))) # Plot Caja &lt;- data %&gt;% ggplot( aes(x=name, y=value, fill=name)) + geom_boxplot() + scale_fill_viridis(discrete = TRUE, alpha=0.6) + geom_jitter(color=&quot;black&quot;, size=0.4, alpha=0.9) + theme_ipsum() + theme( legend.position=&quot;none&quot;, plot.title = element_text(size=11)) + ggtitle(&quot;A boxplot with jitter&quot;) + xlab(&quot;&quot;) Boxplot Caja Gráficos de dispersión library(ggplot2) # The iris dataset is provided natively by R #head(iris) # basic scatterplot dispersion &lt;- ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) + geom_point() 6.10 Ejercicio 8 EJEMPLO Comparar el hábito tabáquico (si/no) de los que tiene cáncer de pulmón o no. # Example data data &lt;- data.frame( SmokingHabit = c(&quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;), LungCancer = c(&quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;) ) # Create a contingency table contingency_table &lt;- table(data$SmokingHabit, data$LungCancer) # Perform the chi-square test chi_square_result &lt;- chisq.test(contingency_table) # Print the chi-square test result print(chi_square_result) ## ## Pearson&#39;s Chi-squared test with Yates&#39; continuity correction ## ## data: contingency_table ## X-squared = 3.75, df = 1, p-value = 0.05281 6.11 Ejercicio 9 EJEMPLO # Cargar la librería necesaria library(stats) # Ejemplo de datos (reemplaza esto con tus propios datos) tratamiento1 &lt;- c(140, 145, 150, 142, 138) tratamiento2 &lt;- c(148, 153, 147, 146, 150) tratamiento3 &lt;- c(135, 138, 142, 137, 139) # Realizar el test de Kruskal-Wallis kruskal_test &lt;- kruskal.test(list(tratamiento1, tratamiento2, tratamiento3)) # Imprimir los resultados del test print(kruskal_test) ## ## Kruskal-Wallis rank sum test ## ## data: list(tratamiento1, tratamiento2, tratamiento3) ## Kruskal-Wallis chi-squared = 9.0837, df = 2, p-value = 0.01065 6.12 Ejercicio 10 EJEMPLO # Cargar la librería necesaria library(stats) # Ejemplo de datos (reemplaza esto con tus propios datos) hombres &lt;- c(3.2, 3.4, 3.1, 3.5, 3.0) mujeres &lt;- c(2.8, 3.0, 2.9, 3.2, 2.7) # Realizar el test de Mann-Whitney U mann_whitney_test &lt;- wilcox.test(hombres, mujeres) # Imprimir los resultados del test print(mann_whitney_test) ## ## Wilcoxon rank sum test with continuity correction ## ## data: hombres and mujeres ## W = 22, p-value = 0.05855 ## alternative hypothesis: true location shift is not equal to 0 6.13 Ejercicio 11 EJEMPLO # Ejemplo de datos peso &lt;- c(60, 70, 65, 80, 75) altura &lt;- c(160, 175, 168, 180, 172) # Realizar el test de correlación de Pearson correlation_test &lt;- cor.test(peso, altura, method = &quot;spearman&quot;) # Imprimir los resultados del test print(correlation_test) ## ## Spearman&#39;s rank correlation rho ## ## data: peso and altura ## S = 2, p-value = 0.08333 ## alternative hypothesis: true rho is not equal to 0 ## sample estimates: ## rho ## 0.9 6.14 Ejercicio 12 EJEMPLO # Cargar la librería necesaria library(stats) # Ejemplo de datos (reemplaza esto con tus propios datos) consumo_alcohol &lt;- c(&quot;Sí&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;Sí&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;) grupo &lt;- c(&quot;Fin de semana&quot;, &quot;No bebedores&quot;, &quot;Bebedores habituales&quot;, &quot;Bebedores habituales&quot;, &quot;Fin de semana&quot;, &quot;No bebedores&quot;, &quot;No bebedores&quot;, &quot;Fin de semana&quot;, &quot;No bebedores&quot;, &quot;Bebedores habituales&quot;) # Crear una tabla de contingencia contingency_table &lt;- table(consumo_alcohol, grupo) # Realizar el test de Chi-Cuadrado de Independencia chi_square_test &lt;- chisq.test(contingency_table) # Imprimir los resultados del test print(chi_square_test) ## ## Pearson&#39;s Chi-squared test ## ## data: contingency_table ## X-squared = 1.3194, df = 2, p-value = 0.517 6.15 Ejercicio 13 EJEMPLO # Ejemplo de datos (reemplaza esto con tus propios datos) peso_inicial &lt;- c(70, 75, 68, 80, 72) peso_despues &lt;- c(60, 50, 56, 70, 65) # Realizar el t-test para muestras relacionadas paired_t_test &lt;- t.test(peso_inicial, peso_despues, paired = TRUE) # Imprimir los resultados del test print(paired_t_test) ## ## Paired t-test ## ## data: peso_inicial and peso_despues ## t = 4.0599, df = 4, p-value = 0.01535 ## alternative hypothesis: true mean difference is not equal to 0 ## 95 percent confidence interval: ## 4.046489 21.553511 ## sample estimates: ## mean difference ## 12.8 6.16 Ejercicio 14 EJEMPLO # Ejemplo de datos (reemplaza esto con tus propios datos) peso_inicial &lt;- c(70, 75, 68, 80, 72) peso_despues &lt;- c(68, 73, 66, 78, 70) # Realizar el test de Wilcoxon para muestras relacionadas wilcoxon_test &lt;- wilcox.test(peso_inicial, peso_despues, paired = TRUE, exact = FALSE) # Imprimir los resultados del test print(wilcoxon_test) ## ## Wilcoxon signed rank test with continuity correction ## ## data: peso_inicial and peso_despues ## V = 15, p-value = 0.03689 ## alternative hypothesis: true location shift is not equal to 0 6.17 Ejercicio 15 EJEMPLO # Ejemplo de datos (reemplaza esto con tus propios datos) antes &lt;- c(&quot;Sí&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;Sí&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;No&quot;) despues &lt;- c(&quot;Sí&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;Sí&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;No&quot;, &quot;Sí&quot;, &quot;Sí&quot;, &quot;Sí&quot;) # Crear una tabla de contingencia 2x2 tabla_contingencia &lt;- table(antes, despues) # Realizar el test de McNemar mcnemar_test &lt;- mcnemar.test(tabla_contingencia) # Imprimir los resultados del test print(mcnemar_test) ## ## McNemar&#39;s Chi-squared test with continuity correction ## ## data: tabla_contingencia ## McNemar&#39;s chi-squared = 0.25, df = 1, p-value = 0.6171 6.18 Ejercicio 16 EJEMPLO ANOVA - posthoc (paramétrico) # Create a sample dataset data &lt;- data.frame( group = rep(c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), each = 10), weight = c(76, 77, 78, 70, 71, 72, 75, 76, 79, 73, 75, 78, 80, 81, 82, 85, 70, 73, 75, 79, 100, 102, 105, 108, 110, 112, 98, 101, 103, 107) ) library(&quot;RcmdrMisc&quot;) ## Loading required package: sandwich with(data,numSummary(weight, groups = group, statistics = c(&quot;mean&quot;, &quot;sd&quot;))) ## mean sd data:n ## A 74.7 3.056868 10 ## B 77.8 4.541170 10 ## C 104.6 4.575296 10 data %&gt;% ggplot(aes(x=group, y=weight, fill=group)) + geom_boxplot() + scale_fill_viridis(discrete = TRUE, alpha=0.6) + geom_jitter(color=&quot;black&quot;, size=0.4, alpha=0.9) + theme_ipsum() + theme( legend.position=&quot;none&quot;, plot.title = element_text(size=11)) + ggtitle(&quot;A boxplot with jitter&quot;) + xlab(&quot;&quot;) # Fit a one-way ANOVA model model &lt;- aov(weight ~ group, data = data) summary(model) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## group 2 5406 2703 159.3 1.13e-15 *** ## Residuals 27 458 17 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 # Perform Tukey&#39;s HSD post hoc test posthoc &lt;- TukeyHSD(model) print(posthoc) ## Tukey multiple comparisons of means ## 95% family-wise confidence level ## ## Fit: aov(formula = weight ~ group, data = data) ## ## $group ## diff lwr upr p adj ## B-A 3.1 -1.467336 7.667336 0.2299903 ## C-A 29.9 25.332664 34.467336 0.0000000 ## C-B 26.8 22.232664 31.367336 0.0000000 Kruskal Wallis - posthoc (no paramétrico) kruskal.test(weight ~group, data = data) ## ## Kruskal-Wallis rank sum test ## ## data: weight by group ## Kruskal-Wallis chi-squared = 20.534, df = 2, p-value = 3.476e-05 El p-valor es &lt;0.05 por lo tanto las medianas de peso para los distintos tipos de actividad física son diferentes. library(FSA) ## Registered S3 methods overwritten by &#39;FSA&#39;: ## method from ## confint.boot car ## hist.boot car ## ## FSA v0.9.5. See citation(&#39;FSA&#39;) if used in publication. ## ## Run fishR() for related website and fishR(&#39;IFAR&#39;) for related book. ## ## Attaching package: &#39;FSA&#39; ## The following object is masked from &#39;package:car&#39;: ## ## bootCase options(scipen=999) dunnTest(weight ~ group, data = data) ## Dunn (1964) Kruskal-Wallis multiple comparison ## p-values adjusted with the Holm method. ## Comparison Z P.unadj P.adj ## 1 A - B -1.067871 0.28557885850 0.28557885850 ## 2 A - C -4.347759 0.00001375355 0.00004126066 ## 3 B - C -3.279888 0.00103848135 0.00207696270 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
